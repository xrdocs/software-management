

<!doctype html>
<html lang="en" class="no-js">
  <head>
    

<meta charset="utf-8">



<!-- begin SEO -->









<title>            IOS-XR ZTP Python Library: Automated provisioning using python (6.2.25+) - Part 1      IOS XR Software Management and ZTP @xrdocs      </title>







<meta property="og:locale" content="en-US">
<meta property="og:site_name" content="IOS XR Software Management and ZTP @xrdocs">
<meta property="og:title" content="IOS-XR ZTP Python Library: Automated provisioning using python (6.2.25+) - Part 1">


  <link rel="canonical" href="https://xrdocs.io/software-management/tutorials/2017-10-25-ios-xr-ztp-python-library-automated-provisioning-using-python/">
  <meta property="og:url" content="https://xrdocs.io/software-management/tutorials/2017-10-25-ios-xr-ztp-python-library-automated-provisioning-using-python/">



  <meta property="og:description" content="Understand the Python ZTP library in IOS-XR, the available methods and build your own python based provisioning scripts for IOS-XR platforms.">



  <meta name="twitter:site" content="@xrdocs">
  <meta name="twitter:title" content="IOS-XR ZTP Python Library: Automated provisioning using python (6.2.25+) - Part 1">
  <meta name="twitter:description" content="Understand the Python ZTP library in IOS-XR, the available methods and build your own python based provisioning scripts for IOS-XR platforms.">
  <meta name="twitter:url" content="https://xrdocs.io/tutorials/2017-10-25-ios-xr-ztp-python-library-automated-provisioning-using-python/">

  
    <meta name="twitter:card" content="summary">
    
      <meta name="twitter:image" content="https://xrdocs.io/software-management/images/packaging-xrdocs.jpg">
    
  

  
    <meta name="twitter:creator" content="@irakshat">
  



  

  





  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2017-10-25T19:50:00+00:00">
  
  
    <link rel="prev" href="https://xrdocs.io/software-management/tutorials/2016-08-26-working-with-ztp/" title="Working with Zero Touch Provisioning">
  



  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "Organization",
      "url": "https://xrdocs.io/software-management",
      "logo": "https://xrdocs.io/software-management/images/packaging-xrdocs.jpg"
    }
  </script>



  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "person",
      "name" : "Cisco Systems Inc",
      "url" : "https://xrdocs.io/software-management",
      "sameAs" : ["https://twitter.com/CiscoDevNet"]
    }
  </script>






<!-- end SEO -->

<link href="https://xrdocs.io/software-management/feed.xml" type="application/atom+xml" rel="alternate" title="IOS XR Software Management and ZTP @xrdocs Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="google-site-verification" content="jgRKKm6B9FwJJPXxpmc0-EP3D0Mh8JHXaJqoYIGj1ek" />

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<script>
if (!(window.location.host.startsWith("127.0.0.1") || window.location.host.startsWith("localhost")) && (window.location.host.substr(-3) == '.io') && (window.location.protocol != "https:"))
    window.location.protocol = "https";
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/software-management/assets/css/main.css">
<meta http-equiv="cleartype" content="on">
<style>
.underline-on-hover:hover {
    text-decoration: underline;
}
.searchForm{
      border-radius:5px;
      -moz-border-radius:5px;
      -webkit-border-radius:5px;
      width: 900px;
   }
#search_results{
      display: table; margin:0 auto;
   }
</style>
</style>

    

<!-- start custom head snippets -->

<link href="https://xrdocs.io/software-management/assets/css/lity.min.css" rel="stylesheet">
<link href="https://xrdocs.io/software-management/assets/css/cisco-sans.min.css" rel="stylesheet">
<link href="https://xrdocs.io/software-management/assets/css/material-scrolltop.css" rel="stylesheet">

<link rel="apple-touch-icon-precomposed" sizes="57x57" href="https://xrdocs.io/software-management/images/apple-touch-icon-57x57.png" />
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://xrdocs.io/software-management/images/apple-touch-icon-114x114.png" />
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://xrdocs.io/software-management/images/apple-touch-icon-72x72.png" />
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://xrdocs.io/software-management/images/apple-touch-icon-144x144.png" />
<link rel="apple-touch-icon-precomposed" sizes="60x60" href="https://xrdocs.io/software-management/images/apple-touch-icon-60x60.png" />
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://xrdocs.io/software-management/images/apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://xrdocs.io/software-management/images/apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://xrdocs.io/software-management/images/apple-touch-icon-152x152.png" />
<link rel="icon" type="image/png" href="https://xrdocs.io/software-management/images/favicon-196x196.png" sizes="196x196" />
<link rel="icon" type="image/png" href="https://xrdocs.io/software-management/images/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/png" href="https://xrdocs.io/software-management/images/favicon-32x32.png" sizes="32x32" />
<link rel="icon" type="image/png" href="https://xrdocs.io/software-management/images/favicon-16x16.png" sizes="16x16" />
<link rel="icon" type="image/png" href="https://xrdocs.io/software-management/images/favicon-128.png" sizes="128x128" />
<link rel="shortcut icon" href="https://xrdocs.io/software-management/images/favicon_cisco.ico" />
<meta name="application-name" content="&nbsp;"/>
<meta name="msapplication-TileColor" content="#FFFFFF" />
<meta name="msapplication-TileImage" content="https://xrdocs.io/software-management/images/mstile-144x144.png" />
<meta name="msapplication-square70x70logo" content="https://xrdocs.io/software-management/images/mstile-70x70.png" />
<meta name="msapplication-square150x150logo" content="https://xrdocs.io/software-management/images/mstile-150x150.png" />
<meta name="msapplication-wide310x150logo" content="https://xrdocs.io/software-management/images/mstile-310x150.png" />
<meta name="msapplication-square310x310logo" content="https://xrdocs.io/software-management/images/mstile-310x310.png" />


<!-- end custom head snippets -->

  </head>

  <body>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu" style="padding-left:2em;">
      <nav id="site-nav" class="greedy-nav">
        <button><div class="navicon"></div></button>
        <ul class="visible-links">
          <img src="https://xrdocs.io/software-management/images/xrdocs_logo.png" width="45px" height="45px" alt="xrdocs logo" style="float:left;">
          <li class="masthead__menu-item masthead__menu-item--lg"><a href="https://xrdocs.io">@xrdocs</a></li>
          <li class="masthead__menu-item"><a href="https://xrdocs.io/software-management/">Software-Management</a></li>
          
            
            
                
                    <li class="masthead__menu-item"><a href="https://xrdocs.io/software-management/blogs/">Blogs</a></li>
                
            


          
            
            
                
                    <li class="masthead__menu-item greedy-nav-active"><a href="https://xrdocs.io/software-management/tutorials/">Tutorials</a></li>
                
            


          
            
            
                
                    <li class="masthead__menu-item"><a href="https://xrdocs.io/software-management/search">Search <i class="fa fa-search" aria-hidden="true"></i></a></li>
                
            


          
            
            
                
                    <li class="masthead__menu-item"><a href="https://xrdocs.io/software-management/tags/">Tags</a></li>
                
            


          
            
            
                
                    <li class="masthead__menu-item"><a href="https://xrdocs.io/software-management/collection-archive/">Archive</a></li>
                
            


          
        </ul>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    



<div id="main" role="main">
  


  <div class="sidebar sticky">
  



<div itemscope itemtype="http://schema.org/Person">

  <div class="author__avatar">
    
    	<img src="https://xrdocs.io/software-management/images/akshat_bio_photo.jpeg" class="author__avatar" alt="Akshat Sharma">
    
  </div>

  <div class="author__content">
    <h3 class="author__name">Akshat Sharma</h3>
    <p class="author__bio">Evangelist, tinkerer, dog-lover and Technical Marketing Engineer, Cisco.</p>
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
      
      
        <li><a href="mailto:akshshar@cisco.com"><i class="fa fa-fw fa-envelope-square" aria-hidden="true"></i> Email</a></li>
      
      
      
        <li><a href="http://twitter.com/irakshat"><i class="fa fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
      
      
      
      
      
      
      
      
      
        <li><a href="http://github.com/akshshar"><i class="fa fa-fw fa-github" aria-hidden="true"></i> Github</a></li>
      
      
      
      
      
      
      
      
      
      
      
      
      
    </ul>
  </div>
  <br><button class="btn"><a href="//pdfcrowd.com/url_to_pdf/" style="color:white">Save as PDF</a></button>
</div>

  
  </div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="IOS-XR ZTP Python Library: Automated provisioning using python (6.2.25+) - Part 1">
    <meta itemprop="description" content="Understand the Python ZTP library in IOS-XR, the available methods and build your own python based provisioning scripts for IOS-XR platforms.">
    <meta itemprop="datePublished" content="October 25, 2017">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 class="page__title" itemprop="headline">IOS-XR ZTP Python Library: Automated provisioning using python (6.2.25+) - Part 1
</h1>
          
            <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 


  8 minutes read
</p>
          
        </header>
      

    

      <section class="page__content" itemprop="text">
        <aside class="sidebar__right">
<nav class="toc">
    <header><h4 class="nav__title"><i class="fa fa-table"></i> IOS-XR ZTP Python</h4></header>
<ul class="toc__menu" id="markdown-toc">
  <li><a href="#introduction" id="markdown-toc-introduction">Introduction</a></li>
  <li><a href="#ncs5508-ztp-setup" id="markdown-toc-ncs5508-ztp-setup">NCS5508 ZTP setup</a></li>
  <li><a href="#the-ztp_helperpy-libary" id="markdown-toc-the-ztp_helperpy-libary">The ztp_helper.py Libary</a>    <ul>
      <li><a href="#library-methods" id="markdown-toc-library-methods">Library Methods:</a></li>
      <li><a href="#sample-run-output" id="markdown-toc-sample-run-output">Sample Run Output</a></li>
    </ul>
  </li>
</ul>

  </nav>
</aside>

<h2 id="introduction">Introduction</h2>

<p>If you’ve not had a chance to play around with Zero Touch Provisioning (ZTP) on IOS-XR, then I would implore you to take a look at the following blogs:</p>

<ul>
  <li><strong>IOS-XR ZTP: Learning through Packet Captures</strong>: Akshat Sharma tells you everything you need to know to understand the DHCP (v4 and v6) server setup and packet captures to illustrate the DHCP options that may be used for classification of devices during provisioning:
    <blockquote>
      <p><a href="https://xrdocs.github.io/software-management/blogs/2017-09-21-ios-xr-ztp-learning-through-packet-captures/">https://xrdocs.github.io/software-management/blogs/2017-09-21-ios-xr-ztp-learning-through-packet-captures/</a></p>
    </blockquote>
  </li>
  <li><strong>Working with ZTP (bash scripts)</strong>: Patrick Warichet walks through the ZTP workflow and illustrates examples of bash scripts for zero touch provisioning using the ZTP bash utilities that enable the bash script to interact with IOS-XR CLI.
    <blockquote>
      <p><a href="https://xrdocs.github.io/software-management/tutorials/2016-08-26-working-with-ztp/">https://xrdocs.github.io/software-management/tutorials/2016-08-26-working-with-ztp/</a></p>
    </blockquote>
  </li>
</ul>

<p>Apart from a new DHCPv4 option introduced in IOS-XR Release 6.2.25 (option 124), both the articles above are valid for IOS-XR starting from release 6.1.2.</p>

<p>In <strong>Part 1</strong> of this tutorial we will introduce a new ZTP library released as part of IOS-XR 6.2.25 that enables users to write ZTP scripts directly in python without having to create wrappers around the native bash utilities (The bash utilities were introduced in XR Release 6.1.2 and are explained here : <a href="https://xrdocs.github.io/software-management/tutorials/2016-08-26-working-with-ztp/#ztp-utilities">ZTP bash utilties</a>). We will finish this tutorial with a simple python ZTP script that will create a root user in XR and exercise some of the methods available in the library.</p>

<p>In <strong>Part 2</strong> of this tutorial, we’ll go a step further and write a much more exhaustive ZTP script, in python, that handles:</p>
<ul>
  <li>Installation of packages in XR : k9sec and mgbl RPMs</li>
  <li>IOS-XR config replace</li>
  <li>Spin up a docker container</li>
  <li>install puppet</li>
  <li>Set up a cron job</li>
  <li>All on a dual RP NCS5500 - so the ZTP script will do initial checkpointing of linux packages and files for us!</li>
</ul>

<p class="notice--success"><strong>Let’s get started!</strong></p>

<h2 id="ncs5508-ztp-setup">NCS5508 ZTP setup</h2>

<p>We will be using an NCS5508 router running IOS-XR 6.2.25 CCO image. Bear in mind that the script we write will work perfectly fine on xrv9k (virtual IOS-XR) as well. This tutorial focuses on NCS5508 in order to have a dual RP setup to play with, especially for Part 2.</p>

<p>The setup looks something like this:</p>

<h2 id="the-ztp_helperpy-libary">The ztp_helper.py Libary</h2>

<p>The ZtpHelpers class is implemented in ztp_helpers.py  script. In this github repository you will find the library itself in the <code class="highlighter-rouge">/lib</code> directory.
This library is available on the router by default starting IOS-XR 6.2.2.
This file will exist at the location:  /pkg/bin/ztp_helper.py  on your router.</p>

<p>The python library is provided in the github repository to help a user easily understand the structure of the library
and then inherit in the user side ztp script.</p>

<p>To utilize the python library and/or inherit in user defined classes, make sure your syspath includes /pkg/bin as
shown below:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import sys
sys.path.append("/pkg/bin/")
from ztp_helper import ZtpHelpers

</code></pre></div></div>

<p>You will find sample scripts to get you started at the root of this github repository.
Specifically:</p>

<ul>
  <li>
    <p><strong>sample_ztp_script.py</strong> : This is a sample ZTP script that creates an inherited class and runs some sample commands to show how XR CLI commands, syslog, error checking woul
d work.</p>
  </li>
  <li>
    <p><strong>exhaustive_ztp_script.py</strong> :  This is a much more exhaustive script. It actually solves a ZTP use case where the mgmt port is placed in a VRF, we enable moving across netw
ork namespaces, set up cron jobs, work with active/standby RPs etc. Use this script to leverage some code pieces in your own script, if needed.</p>
  </li>
</ul>

<h3 id="library-methods">Library Methods:</h3>

<p>This class exposes the following methods and handles all the error handling:</p>

<ul>
  <li><strong>__init__(self, syslog_server=None, syslog_port=None, syslog_file=None)</strong>:
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>         __init__ constructor
        :param syslog_server: IP address of reachable Syslog Server 
        :param syslog_port: Port for the reachable syslog server
        :param syslog_file: Alternative or addon file for syslog
        :type syslog_server: str
        :type syslog_port: int
        :type syslog_file:str

         All parameters are optional. When nothing is specified during object creation, then 
         all logs are sent to a log rotated file /tmp/ztp_python.log (max size of 1MB).
</code></pre></div>    </div>
  </li>
  <li><strong>setns(cls, fd, nstype)</strong>:</li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>           Class Method for setting the network namespace
           :param cls: Reference to the class ZtpHelpers 
           :param fd: incoming file descriptor  
           :param nstype: namespace type for the sentns call
           :type nstype: int  
                  0      Allow any type of namespace to be joined.
                  CLONE_NEWNET = 0x40000000 (since Linux 3.0)
                         fd must refer to a network namespace.
                         
</code></pre></div></div>

<ul>
  <li><strong>get_netns_path(cls, nspath=None, nsname=None, nspid=None)</strong>:</li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>           Class Method to fetch the network namespace filepath 
           associated with a PID or name 
           :param cls: Reference to the class ZtpHelpers
           :param nspath: optional network namespace associated name
           :param nspid: optional network namespace associate PID
           :type nspath: str
           :type nspid: int 
           :return: Return the complete file path 
           :rtype:  str 
           
</code></pre></div></div>

<ul>
  <li><strong>toggle_debug(self, enable)</strong>:</li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>            Enable/disable debug logging
           :param enable: Enable/Disable flag 
           :type enable: int


</code></pre></div></div>

<ul>
  <li><strong>set_vrf(self, vrfname=None)</strong>:</li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>            Set the VRF (network namespace)
           :param vrfname: Network namespace name 
                           corresponding to XR VRF  
                           
</code></pre></div></div>

<ul>
  <li><strong>download_file(self, file_url, destination_folder)</strong>:</li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>            Download a file from the specified URL
           :param file_url: Complete URL to download file 
           :param destination_folder: Folder to store the 
                                      downloaded file
           :type file_url: str
           :type destination_folder: str
           :return: Dictionary specifying download success/failure
                    Failure =&gt; { 'status' : 'error' }
                    Success =&gt; { 'status' : 'success',
                                 'filename' : 'Name of downloaded file',
                                 'folder' : 'Directory location of downloaded file'}
           :rtype: dict 
           
</code></pre></div></div>

<ul>
  <li><strong>setup_syslog(self)</strong>:</li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Method to Correctly set sysloghandler in the correct VRF (network namespace) and 
point to a remote syslog Server or local file or default log-rotated log file.
</code></pre></div></div>

<ul>
  <li><strong>xrcmd(self, cmd=None)</strong>:</li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>            Issue an IOS-XR exec command and obtain the output
           :param cmd: Dictionary representing the XR exec cmd
                       and response to potential prompts
                       { 'exec_cmd': '', 'prompt_response': '' }
           :type cmd: dict            
           :return: Return a dictionary with status and output
                    { 'status': 'error/success', 'output': '' }
           :rtype: dict
</code></pre></div></div>

<ul>
  <li><strong>xrapply(self, filename=None, reason=None)</strong>:</li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>           Apply Configuration to XR using a file 
           :param file: Filepath for a config file
                        with the following structure: 
                        !
                        XR config command
                        !
                        end
           
           :param reason: Reason for the config commit.
                          Will show up in the output of:
                          "show configuration commit list detail"
           :type filename: str
           :type reason: str
           :return: Dictionary specifying the effect of the config change
                     { 'status' : 'error/success', 'output': 'exec command based on status'}
                     In case of Error:  'output' = 'show configuration failed' 
                     In case of Success: 'output' = 'show configuration commit changes last 1'
           :rtype: dict 
</code></pre></div></div>

<ul>
  <li><strong>xrapply_string(self, cmd=None, reason=None)</strong>:</li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>            Apply Configuration to XR using  a single line string
           :param cmd: Single line string representing an XR config command  
           :param reason: Reason for the config commit.
                          Will show up in the output of:
                          "show configuration commit list detail"
           :type cmd: str
           :type reason: str 
           :return: Dictionary specifying the effect of the config change
                     { 'status' : 'error/success', 'output': 'exec command based on status'}
                     In case of Error:  'output' = 'show configuration failed'
                     In case of Success: 'output' = 'show configuration commit changes last 1'
           :rtype: dict
</code></pre></div></div>

<ul>
  <li><strong>xrreplace(self, filename=None)</strong>:</li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>           Replace XR Configuration using a file

           :param file: Filepath for a config file
                        with the following structure:

                        !
                        XR config commands
                        !
                        end
           :type filename: str
           :return: Dictionary specifying the effect of the config change
                     { 'status' : 'error/success', 'output': 'exec command based on status'}
                     In case of Error:  'output' = 'show configuration failed'
                     In case of Success: 'output' = 'show configuration commit changes last 1'
           :rtype: dict
</code></pre></div></div>

<h3 id="sample-run-output">Sample Run Output</h3>
<p>Checkout <code class="highlighter-rouge">sample_ztp_script.py</code> to see how to use the <code class="highlighter-rouge">ZtHelpers</code> Class and to write your own methods in the child class.
The output from <code class="highlighter-rouge">sample_ztp_script.py</code> run on IOS-XR shell when <code class="highlighter-rouge">ztp_helpers.py</code> is available in the <code class="highlighter-rouge">PYTHONPATH</code> is shown below:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[apple2:~]$ python sample_ztp_script.py 

###### Debugs enabled ######


###### Change context to user specified VRF ######


###### Using Child class method, setting the root user ######

2016-12-17 04:23:24,091 - DebugZTPLogger - DEBUG - Config File content to be applied  !
                     username netops
                     group root-lr
                     group cisco-support
                     secret 5 $1$7kTu$zjrgqbgW08vEXsYzUycXw1
                     !
                     end
2016-12-17 04:23:28,546 - DebugZTPLogger - DEBUG - Received exec command request: "show configuration commit changes last 1"
2016-12-17 04:23:28,546 - DebugZTPLogger - DEBUG - Response to any expected prompt ""
Building configuration...
2016-12-17 04:23:29,329 - DebugZTPLogger - DEBUG - Exec command output is ['!! IOS XR Configuration version = 6.2.1.21I', 'username netops', 'group root-lr', 'group cisco-support', 'secret 5 $1$7kTu$zjrgqbgW08vEXsYzUycXw1', '!', 'end']
2016-12-17 04:23:29,330 - DebugZTPLogger - DEBUG - Config apply through file successful, last change = ['!! IOS XR Configuration version = 6.2.1.21I', 'username netops', 'group root-lr', 'group cisco-support', 'secret 5 $1$7kTu$zjrgqbgW08vEXsYzUycXw1', '!', 'end']


###### Debugs Disabled ######


###### Executing a show command ######

Building configuration...
{'output': ['!! IOS XR Configuration version = 6.2.1.21I',
            '!! Last configuration change at Sat Dec 17 04:23:25 2016 by UNKNOWN',
            '!',
            'hostname customer2',
            'username root',
            'group root-lr',
            'group cisco-support',
            'secret 5 $1$7kTu$zjrgqbgW08vEXsYzUycXw1',
            '!',
            'username noc',
            'group root-lr',
            'group cisco-support',
            'secret 5 $1$7kTu$zjrgqbgW08vEXsYzUycXw1',
            '!',
            'username netops',
            'group root-lr',
            'group cisco-support',
            'secret 5 $1$7kTu$zjrgqbgW08vEXsYzUycXw1',
            '!',
            'username netops2',
            'group root-lr',
            'group cisco-support',
            'secret 5 $1$7kTu$zjrgqbgW08vEXsYzUycXw1',
            '!',
            'username netops3',
            'group root-lr',
            'group cisco-support',
            'secret 5 $1$7kTu$zjrgqbgW08vEXsYzUycXw1',
            '!',
            'cdp',
            'service cli interactive disable',
            'interface MgmtEth0/RP0/CPU0/0',
            'ipv4 address 11.11.11.59 255.255.255.0',
            '!',
            'interface TenGigE0/0/0/28/0',
            'shutdown',
            '!',
            'interface TenGigE0/0/0/28/3',
            'shutdown',
            '!',
            'controller Optics0/0/0/28',
            'breakout 4x10',
            '!',
            'interface FortyGigE0/0/0/30',
            'shutdown',
            '!',
            'interface preconfigure FortyGigE0/0/0/28',
            'shutdown',
            '!',
            'router static',
            'address-family ipv4 unicast',
            '0.0.0.0/0 11.11.11.2',
            '!',
            '!',
            'end'],
 'status': 'success'}

###### Apply valid configuration using a file ######

Building configuration...
{'status': 'success', 'output': ['!! IOS XR Configuration version = 6.2.1.21I', 'hostname customer', 'cdp', 'end']}

###### Apply valid configuration using a string ######

Building configuration...
{'output': ['!! IOS XR Configuration version = 6.2.1.21I',
            'hostname customer2',
            'end'],
 'status': 'success'}

###### Apply invalid configuration using a string ######

{'output': ['!! SYNTAX/AUTHORIZATION ERRORS: This configuration failed due to',
            '!! one or more of the following reasons:',
            '!!  - the entered commands do not exist,',
            '!!  - the entered commands have errors in their syntax,',
            '!!  - the software packages containing the commands are not active,',
            '!!  - the current user is not a member of a task-group that has',
            '!!    permissions to use the commands.',
            'hostnaime customer2'],
 'status': 'error'}
[apple2:~]$ 
</code></pre></div></div>

<p>Syslog Messages sent to the server during the run are shown below:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>

2016-12-16T05:14:15-08:00 11.11.11.45 Python: { "loggerName":"ZTPLogger", "asciTime":"2016-12-17 05:24:16,424", "pathName":"ztp_helper.py", "logRecordCreationTime":"1481952256.424373", "functionName":"download_file", "levelNo":"20", "lineNo":"151", "time":"424", "levelName":"INFO", "message":"Downloading file ncs5500-k9sec-2.2.0.0-r62121I.x86_64.rpm from URL:http://11.11.11.2:9090/packages/ncs5500-k9sec-2.2.0.0-r62121I.x86_64.rpm"}
2016-12-16T05:14:15-08:00 11.11.11.45 Python: { "loggerName":"ZTPLogger", "asciTime":"2016-12-17 05:24:16,696", "pathName":"ztp_helper.py", "logRecordCreationTime":"1481952256.696958", "functionName":"install_xr_package", "levelNo":"20", "lineNo":"412", "time":"696", "levelName":"INFO", "message":"Package Download complete, starting installation process"}
2016-12-16T05:14:20-08:00 11.11.11.45 Python: { "loggerName":"ZTPLogger", "asciTime":"2016-12-17 05:24:21,559", "pathName":"ztp_helper.py", "logRecordCreationTime":"1481952261.559930", "functionName":"install_xr_package", "levelNo":"20", "lineNo":"485", "time":"559", "levelName":"INFO", "message":"Installation of ncs5500-k9sec package successsful"}
2016-12-16T05:14:20-08:00 11.11.11.45 Python: { "loggerName":"ZTPLogger", "asciTime":"2016-12-17 05:24:21,565", "pathName":"ztp_helper.py", "logRecordCreationTime":"1481952261.565898", "functionName":"download_file", "levelNo":"20", "lineNo":"151", "time":"565", "levelName":"INFO", "message":"Downloading file ncs5500-mgbl-3.0.0.0-r62121I.x86_64.rpm from URL:http://11.11.11.2:9090/packages/ncs5500-mgbl-3.0.0.0-r62121I.x86_64.rpm"}
2016-12-16T05:14:21-08:00 11.11.11.45 Python: { "loggerName":"ZTPLogger", "asciTime":"2016-12-17 05:24:22,984", "pathName":"ztp_helper.py", "logRecordCreationTime":"1481952262.984670", "functionName":"install_xr_package", "levelNo":"20", "lineNo":"412", "time":"984", "levelName":"INFO", "message":"Package Download complete, starting installation process"}
2016-12-16T05:14:26-08:00 11.11.11.45 Python: { "loggerName":"ZTPLogger", "asciTime":"2016-12-17 05:24:27,819", "pathName":"ztp_helper.py", "logRecordCreationTime":"1481952267.819593", "functionName":"install_xr_package", "levelNo":"20", "lineNo":"485", "time":"819", "levelName":"INFO", "message":"Installation of ncs5500-mgbl package successsful"}
2016-12-16T05:14:37-08:00 11.11.11.45 Python: { "loggerName":"ZTPLogger", "asciTime":"2016-12-17 05:24:38,903", "pathName":"sample_ztp_script.py", "logRecordCreationTime":"1481952278.903180", "functionName":"&lt;module&gt;", "levelNo":"20", "lineNo":"106", "time":"903", "levelName":"INFO", "message":"Hostname updated"}
2016-12-16T05:14:38-08:00 11.11.11.45 Python: { "loggerName":"ZTPLogger", "asciTime":"2016-12-17 05:24:39,482", "pathName":"sample_ztp_script.py", "logRecordCreationTime":"1481952279.482939", "functionName":"&lt;module&gt;", "levelNo":"20", "lineNo":"107", "time":"482", "levelName":"INFO", "message":"{'status': 'success', 'output': ['hostname customer2']}"}

</code></pre></div></div>


        
      </section>

      <footer class="page__meta">
        
        




  
  
  

  <p class="page__taxonomy">
    <strong><i class="fa fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="https://xrdocs.io/software-management/tags/#automate" class="page__taxonomy-item" rel="tag">automate</a><span class="sep">, </span>
    
      
      
      <a href="https://xrdocs.io/software-management/tags/#cisco" class="page__taxonomy-item" rel="tag">cisco</a><span class="sep">, </span>
    
      
      
      <a href="https://xrdocs.io/software-management/tags/#cli" class="page__taxonomy-item" rel="tag">CLI</a><span class="sep">, </span>
    
      
      
      <a href="https://xrdocs.io/software-management/tags/#dhcp" class="page__taxonomy-item" rel="tag">dhcp</a><span class="sep">, </span>
    
      
      
      <a href="https://xrdocs.io/software-management/tags/#iosxr" class="page__taxonomy-item" rel="tag">iosxr</a><span class="sep">, </span>
    
      
      
      <a href="https://xrdocs.io/software-management/tags/#linux" class="page__taxonomy-item" rel="tag">linux</a><span class="sep">, </span>
    
      
      
      <a href="https://xrdocs.io/software-management/tags/#provision" class="page__taxonomy-item" rel="tag">provision</a><span class="sep">, </span>
    
      
      
      <a href="https://xrdocs.io/software-management/tags/#python" class="page__taxonomy-item" rel="tag">python</a><span class="sep">, </span>
    
      
      
      <a href="https://xrdocs.io/software-management/tags/#ztp" class="page__taxonomy-item" rel="tag">ztp</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Updated:</strong> <time datetime="2017-10-25T19:50:00+00:00">October 25, 2017</time></p>
        
      </footer>

      

<section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=https://xrdocs.io/software-management/tutorials/2017-10-25-ios-xr-ztp-python-library-automated-provisioning-using-python/" class="btn btn--twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https://xrdocs.io/software-management/tutorials/2017-10-25-ios-xr-ztp-python-library-automated-provisioning-using-python/" class="btn btn--facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://plus.google.com/share?url=https://xrdocs.io/software-management/tutorials/2017-10-25-ios-xr-ztp-python-library-automated-provisioning-using-python/" class="btn btn--google-plus" title="Share on Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://xrdocs.io/software-management/tutorials/2017-10-25-ios-xr-ztp-python-library-automated-provisioning-using-python/" class="btn btn--linkedin" title="Share on LinkedIn"><i class="fa fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>

    <br>
    <br>
    <br>
</section>


    </div>

    
      

<div class="page__comments">
  <h4 class="page__comments-title">Leave a Comment</h4>
  
    <section id="disqus_thread"></section>
  
</div>
    
  </article>

  
  
</div>


    <div class="page__footer">
      <footer>
        

<div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    
    
      <li><a href="https://twitter.com/xrdocs"><i class="fa fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
    
    
    
      <li><a href="http://github.com/xrdocs"><i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
    
    
    <li><a href="https://xrdocs.io/software-management/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">This site is maintained by Cisco Systems, Inc. employees. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    <script src="https://xrdocs.io/software-management/assets/js/main.min.js"></script>
<script src="https://xrdocs.io/software-management/assets/js/scrollmenu.js"></script>




  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-78256516-1', 'auto');
  ga('send', 'pageview');
</script>






  
  <script type="text/javascript">
  	/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  	var disqus_shortname = 'xrdocs';

  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function() {
  		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  	})();

  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function () {
  		var s = document.createElement('script'); s.async = true;
  		s.type = 'text/javascript';
  		s.src = '//' + disqus_shortname + '.disqus.com/count.js';
  		(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  	}());
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>






<!-- material-scrolltop button -->
<button class="material-scrolltop" type="button"></button>

<!-- material-scrolltop plugin -->
<script src="https://xrdocs.io/software-management/assets/js/material-scrolltop.js"></script>

<!-- Initialize material-scrolltop with (minimal) -->
<script>
    $('body').materialScrollTop();
</script>


  </body>
</html>

